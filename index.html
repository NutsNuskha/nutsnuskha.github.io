<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nuts Nuskha - Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --brand:#8d5a2a;
      --muted:#999;
      --bg:#fff9f3;
      --card:#fff;
      --accent:#25D366; /* whatsapp */
      --glass: rgba(255,255,255,0.85);
      --testimonial-bg: #fff6f0;
    }
    *{box-sizing:border-box}
    body {
      font-family: 'Quicksand', sans-serif;
      text-align: center;
      background-color: var(--bg);
      color: #333;
      padding: 0;
      margin:0;
      -webkit-font-smoothing:antialiased;
    }

    header{display:flex;align-items:center;justify-content:space-between;gap:12px;max-width:1100px;margin:0 auto;padding:12px 16px;position:sticky;top:0;background:linear-gradient(180deg, rgba(255,249,243,0.98), rgba(255,249,243,0.95));z-index:20;border-bottom:1px solid rgba(0,0,0,0.04);}
    .logo {max-width:120px;height:auto}
    .brand-wrap{display:flex;align-items:center;gap:12px}
    h1 {color:var(--brand); margin:0;font-size:1.05rem}
    p.tagline{margin:0;color:#6a4f3b;font-size:0.85rem}
    .nav a{margin:0 8px;text-decoration:none;color:var(--brand);font-weight:600;font-size:0.95rem}
    main{padding:14px}

    .product-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;max-width:1100px;margin:12px auto}
    .card{background:var(--card);border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06);padding:12px;display:flex;gap:12px;align-items:flex-start;transition:transform .18s, box-shadow .18s}
    .card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(0,0,0,0.08)}
    .product-image{width:120px;height:120px;object-fit:cover;border-radius:10px;flex-shrink:0}
    .text{flex:1;text-align:left}
    .text h2{color:#7b3f00;margin:4px 0;font-size:1.02rem}
    .text p{margin:6px 0 8px 0;font-size:0.95rem;color:#444;line-height:1.25}
    .price{font-weight:700;color:#333}
    .strike{color:var(--muted);text-decoration:line-through}

    .button{background-color:var(--accent);color:white;padding:10px 14px;border:none;border-radius:10px;font-size:14px;cursor:pointer}
    .button.secondary{background:#f3f3f3;color:#333;border:1px solid rgba(0,0,0,0.05)}

    .card .add-to-cart {padding: 6px 10px;font-size: 13px;border-radius: 8px;min-width: 110px;max-width: 130px;white-space: nowrap;flex: 0 0 auto !important;background-color: var(--accent);color: #fff}

    @media (max-width:420px){.card .add-to-cart {min-width: 88px;max-width: 100px;padding: 6px 8px;font-size: 12px;}}

    .cart-btn{position:relative;display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;background:#fff;border:1px solid rgba(0,0,0,0.06);cursor:pointer}
    .cart-count{position:absolute;top:-6px;right:-6px;background:#e63946;color:#fff;border-radius:999px;padding:4px 7px;font-size:12px;box-shadow:0 3px 8px rgba(0,0,0,0.15)}
    .cart-modal{position:fixed;right:18px;bottom:18px;width:380px;max-width:calc(100% - 36px);background:var(--glass);backdrop-filter:blur(4px);border-radius:14px;box-shadow:0 18px 40px rgba(0,0,0,0.25);z-index:80;overflow:hidden;display:none}
    .cart-modal.open{display:block}
    .cart-header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.6))}
    .cart-body{max-height:320px;overflow:auto;padding:12px}
    .cart-row{display:flex;gap:10px;align-items:center;border-bottom:1px dashed rgba(0,0,0,0.04);padding:10px 0}
    .cart-row img{width:56px;height:56px;object-fit:cover;border-radius:8px}
    .qty-controls{display:flex;align-items:center;gap:6px}
    .cart-footer{padding:12px;border-top:1px solid rgba(0,0,0,0.06);display:flex;flex-direction:column;gap:8px}

    .social-bar{position:fixed;left:12px;bottom:20px;display:flex;flex-direction:column;gap:8px;z-index:70}
    .social-bar a{display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:50%;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.12);text-decoration:none;color:var(--brand);font-size:18px}
    .gmail-icon {
  width: 20px;     /* small square to visually match icon fonts */
  height: 20px;
  display: block;
  object-fit: contain;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.gmail:hover .gmail-icon {
  transform: scale(1.15);
  opacity: 0.9;
}
    footer{margin-top:34px;font-size:0.9em;color:#555;padding:24px;text-align:center}

    @media (max-width:900px){.product-grid{grid-template-columns:repeat(2,1fr);padding:6px}header{padding:10px}}
    @media (max-width:600px){.product-grid{grid-template-columns:1fr;gap:12px;padding:10px}.card{flex-direction:row;align-items:center;padding:10px}.product-image{width:96px;height:96px}h1{font-size:1rem}.brand-wrap{gap:8px}.nav{display:none}.cart-modal{left:0;right:0;bottom:0;top:auto;width:100%;height:56vh;max-height:80vh;border-radius:12px 12px 0 0}.cart-body{max-height:calc(56vh - 140px)}.sticky-checkout{position:fixed;left:0;right:0;bottom:0;padding:12px;background:linear-gradient(0deg, rgba(255,249,243,0.98), rgba(255,249,243,0.95));box-shadow:0 -6px 18px rgba(0,0,0,0.06);display:flex;justify-content:space-between;align-items:center;gap:12px;z-index:75}.sticky-checkout .button{flex:1}.social-bar{left:auto;right:12px;bottom:90px}}

    /* ===== Testimonials styles ===== */
    .testimonials-section{max-width:1100px;margin:28px auto;padding:18px;border-radius:12px;background:linear-gradient(180deg,var(--testimonial-bg),#fff);box-shadow:0 8px 24px rgba(0,0,0,0.04)}
    .testimonials-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:8px 12px}
    .testimonials-header h3{margin:0;color:#6a3f1f}
    .testimonial-wrap{position:relative;padding:12px}
    .testimonial-card{display:flex;gap:14px;align-items:center;max-width:920px;margin:0 auto;padding:16px;border-radius:10px;background:var(--card);box-shadow:0 8px 20px rgba(0,0,0,0.03);transition:transform .18s}
    .testimonial-avatar{width:64px;height:64px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:700;color:#fff;background:linear-gradient(135deg,#ffb27a,#d67a2b)}
    .testimonial-body{text-align:left;flex:1}
    .testimonial-body p{margin:6px 0;color:#444}
    .testimonial-meta{font-size:13px;color:var(--muted)}
    .stars{color:#f5a623;margin-bottom:6px}

    .testimonial-controls{display:flex;align-items:center;gap:10px;justify-content:center;margin-top:12px}
    .testimonial-controls button{background:transparent;border:1px solid rgba(0,0,0,0.06);padding:8px 10px;border-radius:8px;cursor:pointer}
    .dots{display:flex;gap:8px;align-items:center}
    .dot{width:10px;height:10px;border-radius:999px;background:rgba(0,0,0,0.12);cursor:pointer}
    .dot.active{background:var(--brand)}

    /* Add testimonial form modal */
    .modal-backdrop{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.35);display:none;align-items:center;justify-content:center;z-index:120}
    .modal{background:#fff;padding:16px;border-radius:12px;max-width:480px;width:94%;box-shadow:0 20px 60px rgba(0,0,0,0.25)}
    .modal h4{margin:0 0 8px 0}
    .modal input,.modal textarea, .modal select{width:100%;padding:8px;border-radius:8px;border:1px solid #eee;margin-bottom:8px}

    @media (max-width:600px){.testimonial-card{flex-direction:row;gap:10px}.testimonial-avatar{width:56px;height:56px}}

  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:12px">
      <img src="logo_no_bg - Edited.png" alt="Nuts Nuskha" class="logo">
      <div class="brand-wrap">
        <div>
          <h1>Welcome to Nuts Nuskha</h1>
          <p class="tagline">Wholesome, homemade dry fruits & snacks delivered fresh!</p>
        </div>
      </div>

    </div>

    <div style="display:flex;align-items:center;gap:10px">
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="about.html">About Us</a>
      </nav>

      <button id="openCart" class="cart-btn" aria-label="Open cart">
        <i class="fa-solid fa-cart-shopping"></i>
        <span style="display:inline-block">Cart</span>
        <span id="cartCount" class="cart-count" style="display:none">0</span>
      </button>
    </div>
  </header>

  <main>
    <div class="product-grid" id="productGrid">
      <!-- existing product cards (unchanged) -->

      <article class="card" data-name="Pudina Pop" data-price="175" data-weight="70g" data-img="pudina.png">
        <img class="product-image" src="pudina.png" alt="Pudina Pop">
        <div class="text">
          <h2>Pudina Pop</h2>
          <p>Pudina Pop Makhana ‚Äî Light, crunchy, and roasted in olive oil with a refreshing pudina twist. Roasted | Low-calorie | Nutrient-rich</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs 235</span>
            <div class="price">Rs175 / 70g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20Pudina%20Pop" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

      <article class="card" data-name="The OG Pop" data-price="175" data-weight="70g" data-img="kalimirch.png">
        <img class="product-image" src="kalimirch.png" alt="The OG Pop">
        <div class="text">
          <h2>The OG Pop</h2>
          <p>Salt & Black Pepper Makhana ‚Äî Classic roasted makhana with a dash of salt and pepper. High in fiber | Light & crunchy</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs 235</span>
            <div class="price">Rs175 / 70g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20The%20OG%20Pop" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

      <article class="card" data-name="Gudness Chana" data-price="99" data-weight="150g" data-img="IMG_1262 - Edited.png">
        <img class="product-image" src="IMG_1262 - Edited.png" alt="Gudness Chana">
        <div class="text">
          <h2>Gudness Chana</h2>
          <p>Roasted channa with jaggery, made in ghee</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs 110</span>
            <div class="price">Rs99 / 150g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20Gudness%20Chana" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

      <article class="card" data-name="Power Munch (180g)" data-price="225" data-weight="180g" data-img="IMG_1259 (1) - Edited.png">
        <img class="product-image" src="IMG_1259 (1) - Edited.png" alt="Power Munch">
        <div class="text">
          <h2>Power Munch</h2>
          <p>Roasted, homestyle masala mix of nuts & seeds</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs250</span>
            <div class="price">Rs225 / 180g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20Power%20Munch" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

      <article class="card" data-name="Gud Almonds - Basil Leaf Crush" data-price="229" data-weight="100g" data-img="IMG_1281 - Edited.png">
        <img class="product-image" src="IMG_1281 - Edited.png" alt="Gud Almonds">
        <div class="text">
          <h2>Gud Almonds - Basil Leaf Crush</h2>
          <p>Wholesome almonds with jaggery, packed with energy and immunity-boosting nutrients.</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs279</span>
            <div class="price">Rs229 / 100g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20Gud%20Almonds" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

      <article class="card" data-name="Zesty Cashew" data-price="229" data-weight="100g" data-img="IMG_1246 (1) - Edited.png">
        <img class="product-image" src="IMG_1246 (1) - Edited.png" alt="Zesty Cashew">
        <div class="text">
          <h2>Zesty Cashew</h2>
          <p>Delivers protein, healthy fats, and energy in a crunchy, zesty bite.</p>
          <div style="display:flex;gap:8px;align-items:center">
            <span class="strike">Rs279</span>
            <div class="price">Rs229 / 100g</div>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="button add-to-cart" style="flex:1">Add to cart</button>
            <a class="button secondary" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order%20Zesty%20Cashew" target="_blank">Buy Now</a>
          </div>
        </div>
      </article>

   
    <!-- Order CTA (desktop) -->
    <div style="max-width:1100px;margin:18px auto;text-align:center;padding:0 12px">
      <a class="button" href="https://wa.me/919896309925?text=Hi%20Nuts%20Nuskha!%20I%20want%20to%20order!" target="_blank">Order on WhatsApp</a>
    </div>

    <!-- ===== Testimonials section ===== -->
    <section class="testimonials-section" aria-labelledby="testiTitle">
      <div class="testimonials-header">
        <h3 id="testiTitle">What our customers say</h3>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="prevTestimonial" class="button secondary" aria-label="Previous testimonial">‚Äπ</button>
          <button id="nextTestimonial" class="button" aria-label="Next testimonial">‚Ä∫</button>
          <button id="openAddTestimonial" class="button secondary" style="margin-left:8px">Add Testimonial</button>
        </div>
      </div>

      <div class="testimonial-wrap" id="testimonialWrap" aria-live="polite">
        <!-- testimonial card injected here -->
      </div>

      <div class="testimonial-controls">
        <div class="dots" id="dots"></div>
      </div>
    </section>

  </main>

  <!-- Cart modal (same as before) -->
  <div id="cartModal" class="cart-modal" role="dialog" aria-label="Shopping cart">
    <div class="cart-header">
      <strong>Your Cart</strong>
      <div>
        <button id="clearCart" class="button secondary">Clear</button>
        <button id="closeCart" class="button">Close</button>
      </div>
    </div>
    <div class="cart-body" id="cartBody"></div>
    <div class="cart-footer">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><strong>Total:</strong> <span id="cartTotal">Rs0</span></div>
        <div>
          <button id="checkoutBtn" class="button">Checkout via WhatsApp</button>
        </div>
      </div>
      <small style="color:#666">Pickup & delivery info can be added here. Cart saved in your browser (localStorage).</small>
    </div>
  </div>

  <!-- Add testimonial modal -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="addTestiTitle">
      <h4 id="addTestiTitle">Share your experience</h4>
      <input id="testiName" placeholder="Your name (e.g. Riya Sharma)" />
      <input id="testiLocation" placeholder="Location (optional)" />
      <select id="testiProduct">
        <option value="General">General / Brand</option>
        <option value="Gudness Chana">Gudness Chana</option>
        <option value="Power Munch">Power Munch</option>
        <option value="Gud Almonds">Gud Almonds</option>
        <option value="Zesty Cashew">Zesty Cashew</option>
      </select>
      <textarea id="testiMessage" rows="4" placeholder="What did you like? (short is fine)"></textarea>
      <div style="display:flex;gap:8px;margin-bottom:8px"><label>Rating:</label><select id="testiRating"><option value="5">5</option><option value="4">4</option><option value="3">3</option><option value="2">2</option><option value="1">1</option></select></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button id="cancelTesti" class="button secondary">Cancel</button>
        <button id="saveTesti" class="button">Submit</button>
      </div>
    </div>
  </div>

  <!-- Sticky checkout on mobile -->
  <div class="sticky-checkout" style="display:none" id="mobileCheckout">
    <div style="font-weight:700">Total: <span id="mobileTotal">Rs0</span></div>
    <button id="mobileCheckoutBtn" class="button">Checkout</button>
  </div>

  <!-- Floating social bar (same) -->
  <div class="social-bar" aria-hidden="false">
    <a href="https://wa.me/919896309925" title="WhatsApp" target="_blank" aria-label="WhatsApp" class="whatsapp">
      <i class="fa-brands fa-whatsapp"></i>
    </a>
    <a href="https://www.instagram.com/nutsnuskha" title="Instagram" target="_blank" aria-label="Instagram" class="instagram">
      <i class="fa-brands fa-instagram"></i>
    </a>
    <a href="https://www.facebook.com/" title="Facebook" target="_blank" aria-label="Facebook" class="facebook">
      <i class="fa-brands fa-facebook"></i>
    </a>
    <a href="mailto:nutsnuskha@gmail.com" title="Gmail" aria-label="Gmail" class="gmail">
      <img src="https://www.gstatic.com/images/branding/product/2x/gmail_2020q4_48dp.png" alt="Gmail" class="gmail-icon">
    </a>
  </div>

  <footer>üìç Gurgaon | üìû +91-9896309925 | üìß nutsnuskha@gmail.com</footer>

  <script>
    // ===== existing cart code (keeps functionality) =====
    const CART_KEY = 'nutsnuskha_cart_v1';
    const WA_NUMBER = '+919896309925';

    function getCart(){try{return JSON.parse(localStorage.getItem(CART_KEY)) || [];}catch(e){return []}}
    function saveCart(cart){localStorage.setItem(CART_KEY, JSON.stringify(cart));renderCartCount();renderMobileBar();}
    function addToCart(item){const cart = getCart();const exists = cart.find(p => p.name === item.name);if(exists){ exists.qty += 1; }else { item.qty = 1; cart.push(item); }saveCart(cart);openCartModal();}
    function removeFromCart(name){let cart = getCart().filter(i => i.name !== name);saveCart(cart);renderCart();}
    function updateQty(name, qty){const cart = getCart();const item = cart.find(i => i.name === name);if(!item) return;item.qty = Math.max(0, qty);const filtered = cart.filter(i => i.qty>0);saveCart(filtered);renderCart();}
    function calcTotal(){const cart = getCart();return cart.reduce((s,i)=> s + (Number(i.price) * Number(i.qty||0)), 0);}    
    function renderCartCount(){const cart = getCart();const count = cart.reduce((s,i)=> s + (i.qty||0), 0);const el = document.getElementById('cartCount');if(count>0){ el.style.display='inline-block'; el.textContent = count; }else { el.style.display='none'; }}
    function renderMobileBar(){const mobileBar = document.getElementById('mobileCheckout');const totalEl = document.getElementById('mobileTotal');const total = calcTotal();totalEl.textContent = 'Rs' + total;if(window.innerWidth <= 600 && total>0){ mobileBar.style.display='flex'; }else { mobileBar.style.display='none'; }}
    function renderCart(){const container = document.getElementById('cartBody');const cart = getCart();container.innerHTML = '';if(cart.length===0){ container.innerHTML = '<div style="padding:14px;color:#666">Your cart is empty. Add tasty snacks!</div>'; }cart.forEach(item=>{const row = document.createElement('div'); row.className='cart-row';row.innerHTML = `
          <img src="${item.img}" alt="${item.name}">
          <div style="flex:1;text-align:left">
            <div style="font-weight:700">${item.name}</div>
            <div style="color:#666;font-size:13px">${item.weight} ‚Ä¢ Rs${item.price} each</div>
            <div style="margin-top:8px;display:flex;align-items:center;gap:8px">
              <div class="qty-controls">
                <button class="button secondary qty-minus">-</button>
                <span style="min-width:34px;text-align:center;display:inline-block">${item.qty}</span>
                <button class="button qty-plus">+</button>
              </div>
              <button class="button secondary remove-item">Remove</button>
            </div>
          </div>
        `;row.querySelector('.qty-plus').addEventListener('click', ()=>{ updateQty(item.name, item.qty+1); });row.querySelector('.qty-minus').addEventListener('click', ()=>{ updateQty(item.name, item.qty-1); });row.querySelector('.remove-item').addEventListener('click', ()=>{ removeFromCart(item.name); });container.appendChild(row);});document.getElementById('cartTotal').textContent = 'Rs' + calcTotal();renderCartCount();renderMobileBar();}

    // Initialize add-to-cart buttons (graceful: only if cards exist)
    document.querySelectorAll('.card').forEach(card=>{const btn = card.querySelector('.add-to-cart');if(btn){btn.addEventListener('click', ()=>{const item = {name: card.dataset.name.trim(),price: Number(card.dataset.price),weight: card.dataset.weight || '',img: card.dataset.img || card.querySelector('img')?.src || ''};addToCart(item);});}});

    const cartModal = document.getElementById('cartModal');
    const openCartBtn = document.getElementById('openCart');
    const closeCartBtn = document.getElementById('closeCart');
    const clearCartBtn = document.getElementById('clearCart');
    const checkoutBtn = document.getElementById('checkoutBtn');
    const mobileCheckoutBtn = document.getElementById('mobileCheckoutBtn');

    function openCartModal(){ cartModal.classList.add('open'); renderCart(); }
    function closeCartModal(){ cartModal.classList.remove('open'); }

    openCartBtn.addEventListener('click', ()=>{ openCartModal(); });
    if(closeCartBtn) closeCartBtn.addEventListener('click', ()=>{ closeCartModal(); });

    clearCartBtn.addEventListener('click', ()=>{ if(confirm('Clear all items from cart?')){ localStorage.removeItem(CART_KEY); renderCart(); } });

    function doCheckout(){const cart = getCart();if(cart.length===0){ alert('Your cart is empty'); return; }let message = `Hi Nuts Nuskha! I'd like to place an order:%0A`;cart.forEach(i=>{ message += `- ${i.name} x ${i.qty} (${i.weight}) - Rs${Number(i.price)*Number(i.qty)}%0A`; });message += `%0ATotal: Rs${calcTotal()}%0AName:%0AAddress/Instructions:%0AContact:`;const url = `https://wa.me/${WA_NUMBER.replace('+','')}?text=${message}`;window.open(url,'_blank');}

    checkoutBtn.addEventListener('click', doCheckout);
    if(mobileCheckoutBtn) mobileCheckoutBtn.addEventListener('click', doCheckout);
    renderCartCount();renderMobileBar();
    window.addEventListener('resize', renderMobileBar);
    document.addEventListener('click', (e)=>{ if(e.target.matches('.add-to-cart')){ if(e.shiftKey){ openCartModal(); } } });

    // ===== Testimonials logic =====
    const TESTI_KEY = 'nutsnuskha_testimonials_v1';
    const defaultTestimonials = [
      {name:'Neha Kapoor',location:'Delhi',product:'Gudness Chana',msg:'The Gud Channa reminds me of homemade snacks! Perfect balance of sweetness and crunch ‚Äî my new tea-time favorite!',rating:5},
      {name:'Rohit Mehta',location:'Mumbai',product:'Trail Mix',msg:'Nuts Nuskha trail mix is my go-to energy snack before workouts. Fresh, crunchy, and perfectly roasted!',rating:5},
      {name:'Rahul Bansal',location:'Gurgaon',product:'Gift Hamper',msg:'I gifted Nuts Nuskha hampers to my team this Diwali, and everyone loved them. Classy packaging and super fresh dry fruits!',rating:5}
    ];

    function getTestimonials(){try{return JSON.parse(localStorage.getItem(TESTI_KEY)) || defaultTestimonials.slice();}catch(e){return defaultTestimonials.slice();}}
    function saveTestimonials(arr){localStorage.setItem(TESTI_KEY, JSON.stringify(arr));}

    let testimonials = getTestimonials();
    let activeTesti = 0;
    let testiTimer = null;

    const wrap = document.getElementById('testimonialWrap');
    const dotsEl = document.getElementById('dots');

    function renderTestimonials(){
      testimonials = getTestimonials();
      if(testimonials.length===0){ wrap.innerHTML = '<div style="padding:14px;color:#666">No testimonials yet ‚Äî be the first to share!</div>'; dotsEl.innerHTML=''; return; }
      const t = testimonials[activeTesti % testimonials.length];
      wrap.innerHTML = '';
      const card = document.createElement('div'); card.className='testimonial-card';
      const initials = t.name ? t.name.split(' ').map(s=>s[0]).slice(0,2).join('') : 'NN';
      card.innerHTML = `
        <div class="testimonial-avatar" aria-hidden="true">${initials}</div>
        <div class="testimonial-body">
          <div class="stars">${'‚òÖ'.repeat(t.rating)}${'‚òÜ'.repeat(5-t.rating)}</div>
          <p>"${t.msg.replace(/\"/g,'') }"</p>
          <div class="testimonial-meta">‚Äî ${t.name}${t.location? ', '+t.location : ''} ¬∑ <em>${t.product}</em></div>
        </div>
      `;
      wrap.appendChild(card);

      // render dots
      dotsEl.innerHTML = '';
      testimonials.forEach((_,i)=>{const d = document.createElement('div');d.className='dot'+(i===activeTesti?' active':'');d.addEventListener('click', ()=>{activeTesti=i;renderTestimonials();resetTimer();});dotsEl.appendChild(d);});
    }

    function nextTesti(){ activeTesti = (activeTesti +1) % testimonials.length; renderTestimonials(); }
    function prevTesti(){ activeTesti = (activeTesti -1 + testimonials.length) % testimonials.length; renderTestimonials(); }

    document.getElementById('nextTestimonial').addEventListener('click', ()=>{ nextTesti(); resetTimer(); });
    document.getElementById('prevTestimonial').addEventListener('click', ()=>{ prevTesti(); resetTimer(); });

    // Auto-rotate
    function startTimer(){ if(testiTimer) clearInterval(testiTimer); testiTimer = setInterval(nextTesti, 5000); }
    function resetTimer(){ startTimer(); }

    wrap.addEventListener('mouseenter', ()=>{ if(testiTimer) clearInterval(testiTimer); });
    wrap.addEventListener('mouseleave', ()=>{ startTimer(); });

    // Add testimonial modal handling
    const modal = document.getElementById('modalBackdrop');
    document.getElementById('openAddTestimonial').addEventListener('click', ()=>{ modal.style.display='flex'; document.getElementById('testiName').focus(); });
    document.getElementById('cancelTesti').addEventListener('click', ()=>{ modal.style.display='none'; });

    document.getElementById('saveTesti').addEventListener('click', ()=>{
      const name = document.getElementById('testiName').value.trim() || 'Anonymous';
      const location = document.getElementById('testiLocation').value.trim();
      const product = document.getElementById('testiProduct').value;
      const msg = document.getElementById('testiMessage').value.trim() || 'Great product!';
      const rating = parseInt(document.getElementById('testiRating').value,10) || 5;
      const arr = getTestimonials();
      arr.unshift({name,location,product,msg,rating}); // add to top
      saveTestimonials(arr);
      testimonials = arr;
      activeTesti = 0;
      renderTestimonials();
      modal.style.display='none';
      // clear form
      document.getElementById('testiName').value='';document.getElementById('testiLocation').value='';document.getElementById('testiMessage').value='';document.getElementById('testiRating').value='5';
    });

    // initialize
    renderTestimonials(); startTimer();

  </script>
</body>
</html>

